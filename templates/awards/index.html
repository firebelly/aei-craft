{% extends (craft.app.request.isAjax and not craft.request.isLivePreview) ? "_ajax-layout" : "_layout" %}

{% set bodyClass = 'white-header' %}
{% block content %}

<div class="row -halves">
  <div class="row-block">
    <div class="module text-module">
      <div class="font-h1 no-margin user-content">{{ entry.description }}</div>
    </div>
  </div>
</div>

<div class="award-table margin-vertical">
  <table class="sortable">
    <thead>
      <th>Awards &amp; Recognitions <svg class="icon icon-down-arrow"><use xlink:href="#icon-down-arrow" /></svg></th>
      <th class="year">Year <svg class="icon icon-down-arrow"><use xlink:href="#icon-down-arrow" /></svg></th>
      <th>Project <svg class="icon icon-down-arrow"><use xlink:href="#icon-down-arrow" /></svg></th>
    </thead>
    <tbody>
      {% for award in craft.entries.section('awards').orderBy('title asc').all() %}
        <tr>
          <td>{{ award.title }}{{ award.title and award.awardIssuer ? ' - ' : ''}}{{ award.awardIssuer }}</td>
          <td>{{ award.awardDate|date('Y') }}</td>

          {% set project = craft.entries.section('projects').relatedTo({ element: award }).one() %}
          <td>
            {% if project %}
              <a href="{{ project.getUrl() }}">{{ project.title }}</a>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
